<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/><link rel="stylesheet" href="lpdoc.css" type="text/css"/><title>Run time usage of objects &mdash; The Ciao System v1.14#2</title></head><body><div class="nav"><span class="on_right"><a class="navbutton" href="objects_doc.html">&#x25C4;</a><a class="navbutton" href="interface_doc.html">&#x25BA;</a></span><span><a href="ciao.html">The Ciao System</a> &raquo; <a href="ExtendProlog.html">PART VII - Ciao extensions</a> &raquo; <a href="ociao_doc.html">Object Oriented Programming</a> &raquo; </span></div><div class="documentwrapper"><div class="document"><div class="mainwrapper"><div class="main"><div id=""><h1>Run time usage of objects</h1><a class="idx_anchor" href="ciaoliindex.html#objects_rt"></a>
<strong>Author(s):</strong> <a class="idx_anchor" id="Angel Fernandez Pineda" href="ciaoauindex.html#Angel Fernandez Pineda">Angel Fernandez Pineda</a>, <a class="idx_anchor" id="Angel Fernandez Pineda" href="ciaoauindex.html#Angel Fernandez Pineda">Angel Fernandez Pineda</a>.<p>
This library provides run-time support for <a class="idx_anchor" id="0" href="ciaoglindex.html#object">object</a> creation and manipulation. Objects are also called <a class="idx_anchor" id="1" href="ciaoglindex.html#class instances">class instances</a>, or simply <a class="idx_anchor" id="2" href="ciaoglindex.html#instances">instances</a>.<p>Objects in Ciao are treated as normal modules. This is, an object is a run-time generated Prolog module, which may be identified by an unique term across the whole application.<p>This is a very simple example of how to create an instance, and how to make calls to it:<p><pre>            AnObj new myclass,
            AnObj:mymethod.
         </pre> <p>In order to make any object accessible from code, an usage relationship must be established between the class (from which instances are derived) and the code itself. Refer to <a class="idx_anchor" id="3" href="ciaoglindex.html#use_class/1"><tt>use_class/1</tt></a> predicate or <a class="idx_anchor" id="4" href="ciaoglindex.html#use_class/1"><tt>use_class/1</tt></a> declaration in order to do so. <br/><div id="Usage and interface"><h2>Usage and interface</h2><div class="cartouche"><ul><LI><strong>Library usage:</strong><br/>This library is automatically loaded when using the <em>objects</em> package: <pre>    :- module(<em>ModuleName</em>,<em>Exports</em>,[objects]).
</pre> Nothing special needs to be done. <LI><strong>Exports:</strong><br/><ul class="itemize_minus"><LI><em>Predicates:</em><br/><a class="idx_anchor" id="5" href="ciaoglindex.html#new/2"><tt>new/2</tt></a>, <a class="idx_anchor" id="6" href="ciaoglindex.html#instance_of/2"><tt>instance_of/2</tt></a>, <a class="idx_anchor" id="7" href="ciaoglindex.html#derived_from/2"><tt>derived_from/2</tt></a>, <a class="idx_anchor" id="8" href="ciaoglindex.html#interface/2"><tt>interface/2</tt></a>, <a class="idx_anchor" id="9" href="ciaoglindex.html#instance_codes/2"><tt>instance_codes/2</tt></a>, <a class="idx_anchor" id="10" href="ciaoglindex.html#destroy/1"><tt>destroy/1</tt></a>, <a class="idx_anchor" id="11" href="ciaoglindex.html#use_class/1"><tt>use_class/1</tt></a>.
<LI><em>Properties:</em><br/><a class="idx_anchor" id="12" href="ciaoglindex.html#constructor/1"><tt>constructor/1</tt></a>, <a class="idx_anchor" id="13" href="ciaoglindex.html#class_name/1"><tt>class_name/1</tt></a>, <a class="idx_anchor" id="14" href="ciaoglindex.html#interface_name/1"><tt>interface_name/1</tt></a>, <a class="idx_anchor" id="15" href="ciaoglindex.html#instance_id/1"><tt>instance_id/1</tt></a>, <a class="idx_anchor" id="16" href="ciaoglindex.html#class_source/1"><tt>class_source/1</tt></a>, <a class="idx_anchor" id="17" href="ciaoglindex.html#interface_source/1"><tt>interface_source/1</tt></a>, <a class="idx_anchor" id="18" href="ciaoglindex.html#method_spec/1"><tt>method_spec/1</tt></a>, <a class="idx_anchor" id="19" href="ciaoglindex.html#virtual_method_spec/1"><tt>virtual_method_spec/1</tt></a>.
</ul><LI><strong>Other modules used:</strong><br/><ul class="itemize_minus"><LI><em>System library modules:</em><br/><a class="idx_anchor" id="20" href="ciaoglindex.html#compiler/compiler"><tt>compiler/compiler</tt></a>, <a class="idx_anchor" id="21" href="ciaoglindex.html#prolog_sys"><tt>prolog_sys</tt></a>.
</ul></ul></div></div><div id="Documentation on exports"><h2>Documentation on exports</h2><div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="new/2" href="ciaopdindex.html#new/2">new/2</a>:</div><div class="deftext">Dynamic instance creation takes place by the ways of this predicate.<p>It takes a free variable as first argument which will be instantiated to an internal object identifier.<p>Second argument must be instantiated to a <a class="idx_anchor" id="22" href="ciaoglindex.html#class constructor">class constructor</a>. Class constructors are designed to perform an initialization on the new created instance. Notice that instance initialization may involve some kind of computation, not only <em>state initialization</em>.<p>A class constructor is made by a functor, which must match the intended class name, and any number of parameters. For example:<p><pre>            Obj new myclass(1500,&apos;hello, world!!!&apos;)
         </pre> <p>Those parameters depends (obviously) on the constructors defined at the class source. If no constructors where defined, no parameters are needed. This is called the <a class="idx_anchor" id="23" href="ciaoglindex.html#default constructor">default constructor</a>. An example:<p><pre>            Obj new myclass
         </pre> <p>The default constructor can not be called if there is any constructor available at the class source.<p>Instantiation will raise an exception and fail whenever any of this conditions occur: <ul> <LI>First argument is not a free variable. <LI>Second argument functor is a class, but there is no usage relationship with it. <LI>Second argument functor is not a class. <LI>The given constructor is unknown. <LI>The given constructor fails (notice that default constructor never fails). </ul> <p>Objects may also be statically declared, refer to <a class="idx_anchor" id="24" href="ciaoglindex.html#instance_of/2"><tt>instance_of/2</tt></a> declaration. <p><strong>Usage:</strong> <tt>new(InstanceVar,Constructor)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Creates a new instance of the class specified by <span class="var">Constructor</span> returning its identifier in <span class="var">InstanceVar</span><LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">InstanceVar</span> is a free variable.
</span><br/><span class="on_right"> (objects_rt:constructor/1)</span><span><span class="var">Constructor</span> is a term whose functor matches a class name.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">InstanceVar</span> is an unique term which identifies an object.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="instance_of/2" href="ciaopdindex.html#instance_of/2">instance_of/2</a>:</div><div class="deftext">This predicate is used to perform dynamic type checking. You may check whether a particular instance belongs to a particular class or related descendants.<p>instance_of/2 is used to perform static <a class="idx_anchor" id="25" href="ciaoglindex.html#semantic analisys">semantic analisys</a> over object oriented code constructions.<p>By the use of instance_of/2 you may help to perform such analisys. <p><strong>Usage 1:</strong> <tt>instance_of(Instance,Class)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Test whether <span class="var">Instance</span> was derived from any descendant of <span class="var">Class</span>, or that class itself<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">Instance</span> is an unique term which identifies an object.
</span><br/><span class="on_right"> (objects_rt:class_name/1)</span><span><span class="var">Class</span> is an atom denoting a class.
</span>
</ul><p><strong>Usage 2:</strong> <tt>instance_of(Instance,Class)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Retrieves, on backtracking, the inheritance line of <span class="var">Instance</span> commencing on the creation class (that specified on call to <a class="idx_anchor" id="26" href="ciaoglindex.html#new/2"><tt>new/2</tt></a>) and continuing on the rest of ascendant classes, if any.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">Instance</span> is an unique term which identifies an object.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Class</span> is a free variable.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (objects_rt:class_name/1)</span><span><span class="var">Class</span> is an atom denoting a class.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="derived_from/2" href="ciaopdindex.html#derived_from/2">derived_from/2</a>:</div><div class="deftext">Test whether an object identifier was derived directly from a class, by the usage of <a class="idx_anchor" id="27" href="ciaoglindex.html#new/2"><tt>new/2</tt></a> or a static instance declaration (<a class="idx_anchor" id="28" href="ciaoglindex.html#instance_of/2"><tt>instance_of/2</tt></a>). <p><strong>Usage 1:</strong> <tt>derived_from(Instance,Class)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Test derivation of <span class="var">Instance</span> from <span class="var">Class</span><LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">Instance</span> is an unique term which identifies an object.
</span><br/><span class="on_right"> (objects_rt:class_name/1)</span><span><span class="var">Class</span> is an atom denoting a class.
</span>
</ul><p><strong>Usage 2:</strong> <tt>derived_from(Instance,Class)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Retrieves the <span class="var">Class</span> responsable of the derivation of <span class="var">Instance</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">Instance</span> is an unique term which identifies an object.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Class</span> is a free variable.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (objects_rt:class_name/1)</span><span><span class="var">Class</span> is an atom denoting a class.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="interface/2" href="ciaopdindex.html#interface/2">interface/2</a>:</div><div class="deftext">This predicate is used to ensure a given interface to be implemented by a given instance. <p><strong>Usage 1:</strong> <tt>interface(Instance,Interface)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Check whether <span class="var">Instance</span> implements the given <span class="var">Interface</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">Instance</span> is an unique term which identifies an object.
</span><br/><span class="on_right"> (objects_rt:interface_name/1)</span><span><span class="var">Interface</span> is an unique atom which identifies a public interface.
</span>
</ul><p><strong>Usage 2:</strong> <tt>interface(Instance,Interfaces)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Retrieves on backtracking all the implemented <span class="var">Interfaces</span> of <span class="var">Instance</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">Instance</span> is an unique term which identifies an object.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Interfaces</span> is a free variable.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (objects_rt:interface_name/1)</span><span><span class="var">Interfaces</span> is an unique atom which identifies a public interface.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="instance_codes/2" href="ciaopdindex.html#instance_codes/2">instance_codes/2</a>:</div><div class="deftext">Retrieves a character string representation from an object identifier and vice-versa. <p><strong>Usage 1:</strong> <tt>instance_codes(Instance,String)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Retrieves a <span class="var">String</span> representation of given <span class="var">Instance</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">Instance</span> is an unique term which identifies an object.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">String</span> is a free variable.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:string/1)</span><span><span class="var">String</span> is a string (a list of character codes).
</span>
</ul><p><strong>Usage 2:</strong> <tt>instance_codes(Instance,String)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Reproduces an <span class="var">Instance</span> from its <span class="var">String</span> representation. Such an instance must be alive across the application: this predicate will fail whether the involved instance has been destroyed. <LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Instance</span> is a free variable.
</span><br/><span class="on_right"> (basic_props:string/1)</span><span><span class="var">String</span> is a string (a list of character codes).
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">Instance</span> is an unique term which identifies an object.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="destroy/1" href="ciaopdindex.html#destroy/1">destroy/1</a>:</div><div class="deftext">As well as instances are created, they must be destroyed when no longer needed in order to release system resources.<p>Unfortunately, current O&apos;Ciao implementation does not support automatic instance destruction, so user must manually call <em>destroy/1</em> in order to do so.<p>The programmer <strong>must ensure</strong> that no other references to the involved object are left in memory when destroy/1 is called. If not, unexpected results may be obtained. <p><strong>Usage:</strong> <tt>destroy(Instance)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Destroys the object identified by <span class="var">Instance</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (objects_rt:instance_id/1)</span><span><span class="var">Instance</span> is an unique term which identifies an object.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="use_class/1" href="ciaopdindex.html#use_class/1">use_class/1</a>:</div><div class="deftext">The behaviour of this predicate is identical to that provided by the declaration of the same name <a class="idx_anchor" id="29" href="ciaoglindex.html#use_class/1"><tt>use_class/1</tt></a>. It allows user programs to dynamically load classes. Whether the given source is not a class it will perform a <a class="idx_anchor" id="30" href="ciaoglindex.html#use_module/1"><tt>use_module/1</tt></a> predicate call.<p><strong>Usage:</strong> <tt>use_class(ClassSource)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Dynamically loads the given <span class="var">ClassSource</span><LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (objects_rt:class_source/1)</span><span><span class="var">ClassSource</span> is a valid path to a prolog file containing a class declaration (without .pl extension).
</span>
</ul></div></div><p>
<div><span class="on_right">PROPERTY</span><div class="defname"><a class="idx_anchor" id="constructor/1" href="ciaoprindex.html#constructor/1">constructor/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>constructor(Cons)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">Cons</span> is a term whose functor matches a class name.</ul></div></div><p>
<div><span class="on_right">PROPERTY</span><div class="defname"><a class="idx_anchor" id="class_name/1" href="ciaoprindex.html#class_name/1">class_name/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>class_name(ClassName)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">ClassName</span> is an atom denoting a class.</ul></div></div><p>
<div><span class="on_right">PROPERTY</span><div class="defname"><a class="idx_anchor" id="interface_name/1" href="ciaoprindex.html#interface_name/1">interface_name/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>interface_name(Interface)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">Interface</span> is an unique atom which identifies a public interface.</ul></div></div><p>
<div><span class="on_right">PROPERTY</span><div class="defname"><a class="idx_anchor" id="instance_id/1" href="ciaoprindex.html#instance_id/1">instance_id/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>instance_id(ID)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">ID</span> is an unique term which identifies an object.</ul></div></div><p>
<div><span class="on_right">PROPERTY</span><div class="defname"><a class="idx_anchor" id="class_source/1" href="ciaoprindex.html#class_source/1">class_source/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>class_source(Source)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">Source</span> is a valid path to a prolog file containing a class declaration (without .pl extension).</ul></div></div><p>
<div><span class="on_right">PROPERTY</span><div class="defname"><a class="idx_anchor" id="interface_source/1" href="ciaoprindex.html#interface_source/1">interface_source/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>interface_source(Source)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">Source</span> is a valid path to a prolog file containing a class declaration or an interface declaration (without .pl extension).</ul></div></div><p>
<div><span class="on_right">PROPERTY</span><div class="defname"><a class="idx_anchor" id="method_spec/1" href="ciaoprindex.html#method_spec/1">method_spec/1</a>:</div><div class="deftext">There is no difference between method or attribute specifications, and habitual predicate specifications. It is just a Functor/Arity term. <p><strong>Usage:</strong> <tt>method_spec(Spec)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">Spec</span> is a method or attribute specification.</ul></div></div><p>
<div><span class="on_right">PROPERTY</span><div class="defname"><a class="idx_anchor" id="virtual_method_spec/1" href="ciaoprindex.html#virtual_method_spec/1">virtual_method_spec/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>virtual_method_spec(Spec)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">Spec</span> is a method specification.</ul></div></div><p>
</div><div id="Known bugs and planned improvements"><h2>Known bugs and planned improvements</h2><ul><LI>Usage of objects from the <tt>user</tt> module does not work properly. It is better to use the <tt>objects</tt> package in a (proper) module.<LI>Not really a bug: when loading code which declares static instances from the toplevel shell, predicate <a class="idx_anchor" id="31" href="ciaoglindex.html#use_module/1"><tt>use_module/1</tt></a>) will not work properly: those instances may be not correctly created, and predicates will fail whenever they are not supposed to do. This may be avoided by reloading again the involved module, but make sure it is modified and saved to disk before doing so. </ul></div></div></div></div></div><div class="sidebarwrapper"><div class="sidebar"><IMG SRC="autofigciao-shadow-64h.png"><h2>Module Sections</h2><ul><LI><a href="#Usage and interface">Usage and interface</a><LI><a href="#Documentation on exports">Documentation on exports</a><LI><a href="#Known bugs and planned improvements">Known bugs and planned improvements</a></ul><h2>Global Links</h2><ul><LI><a href="ciaofulltoc.html">Table of Contents</a><LI><a href="ciaochanges.html">Version/Change Log</a><LI><a href="ciaorefs.html">References</a><LI><a href="ciaocopyright.html">Copyright</a></ul><h2>Indices</h2><ul><LI><a href="ciaoliindex.html">Library/Module Index</a><LI><a href="ciaopdindex.html">Predicate/Method Index</a><LI><a href="ciaoprindex.html">Property Index</a><LI><a href="ciaoteindex.html">Regular Type Index</a><LI><a href="ciaodeindex.html">Declaration Index</a><LI><a href="ciaocoindex.html">Concept Index</a><LI><a href="ciaoauindex.html">Author Index</a><LI><a href="ciaoglindex.html">Global Index</a></ul></div></div><div class="clearer"></div></div><div class="nav"><span class="on_right"><a class="navbutton" href="objects_doc.html">&#x25C4;</a><a class="navbutton" href="interface_doc.html">&#x25BA;</a></span><span>&nbsp;</span></div><div class="footer">Generated with LPdoc using Ciao</div></body></html>