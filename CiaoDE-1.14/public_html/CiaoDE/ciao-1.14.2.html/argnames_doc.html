<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/><link rel="stylesheet" href="lpdoc.css" type="text/css"/><title>Terms with named arguments -records/feature terms &mdash; The Ciao System v1.14#2</title></head><body><div class="nav"><span class="on_right"><a class="navbutton" href="hiordlib.html">&#x25C4;</a><a class="navbutton" href="fsyntax_doc.html">&#x25BA;</a></span><span><a href="ciao.html">The Ciao System</a> &raquo; <a href="ExtendProlog.html">PART VII - Ciao extensions</a> &raquo; </span></div><div class="documentwrapper"><div class="document"><div class="mainwrapper"><div class="main"><div id=""><h1>Terms with named arguments -records/feature terms</h1><a class="idx_anchor" href="ciaoliindex.html#argnames"></a>
<strong>Author(s):</strong> <a class="idx_anchor" id="Daniel Cabeza" href="ciaoauindex.html#Daniel Cabeza">Daniel Cabeza</a>, <a class="idx_anchor" id="Manuel Hermenegildo" href="ciaoauindex.html#Manuel Hermenegildo">Manuel Hermenegildo</a>, <a class="idx_anchor" id="Jose F. Morales" href="ciaoauindex.html#Jose F. Morales">Jose F. Morales</a>.<p>
<a class="idx_anchor" id="0" href="ciaocoindex.html#Naming term arguments"></a> This library package provides syntax which allows accessing term arguments by name (these terms are sometimes also referred to as <a class="idx_anchor" id="1" href="ciaocoindex.html#records"><em>records</em></a>, and are also similar to <a class="idx_anchor" id="2" href="ciaocoindex.html#feature terms"><em>feature terms</em></a> [<a href="ciaorefs.html#Ait-KaciPodelskiSmolka92">AKPS92</a>]).<br/><div id="Usage and interface"><h2>Usage and interface</h2><div class="cartouche"><ul><LI><strong>Library usage:</strong><br/><tt>:- use_package(argnames).</tt>

or

<tt>:- module(...,...,[argnames]).</tt><LI><strong>Exports:</strong><br/><ul class="itemize_minus"><LI><em>Predicates:</em><br/><a class="idx_anchor" id="3" href="ciaoglindex.html#$~/3"><tt>$~/3</tt></a>.
</ul><LI><strong>New operators defined:</strong><br/><a class="idx_anchor" id="4" href="ciaoglindex.html#$/2"><tt>$/2</tt></a> [150,xfx], <a class="idx_anchor" id="5" href="ciaoglindex.html#=&gt;/2"><tt>=&gt;/2</tt></a> [950,xfx], <a class="idx_anchor" id="6" href="ciaoglindex.html#argnames/1"><tt>argnames/1</tt></a> [1150,fx].
<LI><strong>New declarations defined:</strong><br/><a class="idx_anchor" id="7" href="ciaoglindex.html#argnames/1"><tt>argnames/1</tt></a>.
</ul></div></div><div id="Documentation on new declarations"><h2>Documentation on new declarations</h2><div><span class="on_right">DECLARATION</span><div class="defname"><a class="idx_anchor" id="argnames/1" href="ciaodeindex.html#argnames/1">argnames/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> :- <tt>argnames ArgNamedPredSpec</tt>.
<ul class="itemize_minus"><LI><em>Description:</em> An <a class="idx_anchor" id="8" href="ciaoglindex.html#argnames/1"><tt>argnames/1</tt></a> declaration assigns names to the argument positions of terms (or literal/goals) which use a certain functor/arity. This allows referring to these arguments by their name rather than by their argument position. Sometimes, argument names may be clearer and easier to remember than argument positions, specially for predicates with many arguments. Also, in some cases this may allow adding arguments to certain predicates without having to change the code that uses them. These terms with named arguments are sometimes also referred to as <a class="idx_anchor" id="9" href="ciaoglindex.html#records">records</a>, and are also similar to <a class="idx_anchor" id="10" href="ciaoglindex.html#feature terms">feature terms</a> [<a href="ciaorefs.html#Ait-KaciPodelskiSmolka92">AKPS92</a>]. For example, in order to write a program for the <em>zebra</em> puzzle we might declare:<p><pre>:- use_package([argnames]).
:- argnames house(color, nation, pet, drink, car).
</pre> <p>which first includes the package and then assigns a name to each of the arguments of any term (or literal/goal) with <tt>house/5</tt> as the main functor.<p>For convenience the package extends the built-in <a class="idx_anchor" id="11" href="ciaoglindex.html#data/1"><tt>data/1</tt></a> declaration so that names to arguments can be asigned as with the <a class="idx_anchor" id="12" href="ciaoglindex.html#argnames/1"><tt>argnames/1</tt></a> declaration, as for example:<p><pre>:- data product(id, description, brand, quantity).
</pre> <p>Once an <a class="idx_anchor" id="13" href="ciaoglindex.html#argnames/1"><tt>argnames/1</tt></a> is given, it is possible to use the names to refer to the arguments of any term (or literal/goal) which has the same main functor as that of the term which appears in the <a class="idx_anchor" id="14" href="ciaoglindex.html#argnames/1"><tt>argnames/1</tt></a> declaration. This is done by first writing the functor name, then the infix operator <tt>$</tt>, and then, between curly brackets, zero, one, or more pairs <em>argument-name</em><tt>=&gt;</tt><em>argument-value</em>, separated by commas (i.e., the infix operator <tt>=&gt;</tt> is used between the name and the value). Again, argument names must be atomic. Argument values can be any term. Arguments which are not specified are assumed to have a value of &ldquo;<tt>_</tt>&rdquo; (i.e., they are left unconstrained).<p>Thus, after the declaration for <tt>house/5</tt> in the example above, any ocurrence in that code of, for example, <tt>house${nation=&gt;Owns_zebra,pet=&gt;zebra}</tt> is exactly equivalent to <tt>house(_,Owns_zebra,zebra,_,_)</tt>. Also, <tt>house${}</tt> is equivalent to <tt>house(_,_,_,_,_)</tt>. The actual zebra puzzle specification might include a clause such as:<p><pre>zebra(Owns_zebra, Drinks_water, Street) :-
   Street = [house${},house${},house${},house${},house${}],
   member(house${nation=&gt;Owns_zebra,pet=&gt;zebra}, Street),
   member(house${nation=&gt;Drinks_water,drink=&gt;water}, Street),
   member(house${drink=&gt;coffee,color=&gt;green}, Street),
   left_right(house${color=&gt;ivory}, house${color=&gt;green}, Street),
   member(house${car=&gt;porsche,pet=&gt;snails}, Street),
        ...
</pre> <p>Another syntax supported, useful mainly in declarations to avoid specifying the arity, is <tt>house${/}</tt>, which is equivalent in our example to <tt>house/5</tt> (but for data declarations there is a special syntax as we have seen).<p>Any number of <a class="idx_anchor" id="15" href="ciaoglindex.html#argnames/1"><tt>argnames/1</tt></a> declarations can appear in a file, one for each functor whose arguments are to be accessed by name. As with other packages, argument name declarations are <em>local to the file</em> in which they appear. The <a class="idx_anchor" id="16" href="ciaoglindex.html#argnames/1"><tt>argnames/1</tt></a> declarations affect only program text which appears after the declaration. It is easy to make a set of declarations affect several files for example by putting such declarations in a sepatate file which is included by all such files.<p>An <a class="idx_anchor" id="17" href="ciaoglindex.html#argnames/1"><tt>argnames/1</tt></a> declaration does not change in any way the internal representation of the associated terms and does not affect run-time efficiency. It is simply syntactic sugar.<p><p>  <strong>Runtime support</strong> <p>It is possible to write pairs with unbound argument names. In that case, runtime information is emitted to resolve the argument name at execution time. </ul></div></div><p>
</div><div id="Documentation on exports"><h2>Documentation on exports</h2><div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="$~/3" href="ciaopdindex.html#$~/3">$~/3</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>$~(Term,Replacement,NewTerm)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">NewTerm</span> is as <span class="var">Term</span> but with the arguments specified in <span class="var">Replacement</span> changed (they need to be in argnames syntax). The predicate is in fact virtual, since it is translated by the package to a pair of unifications. For example, given the declaration <tt>:- argnames house(color, nation, pet, drink, car)</tt>, the goal <pre>   $~(House, house${car =&gt; seat, pet =&gt; mouse}, NewHouse)
</pre> would be compiled to the unifications <pre>   House = house(C,N,_,D,_), NewHouse = house(C,N,mouse,D,seat).
</pre></ul></div></div><p>
</div><div id="Other information"><h2>Other information</h2>
<p>Two simple examples of the use of the argnames library package follow.<p><div id="Using argument names in a toy database"><h3>Using argument names in a toy database</h3> <p><pre>:- module(simple_db,_,[argnames,assertions,regtypes]).
:- use_module(library(aggregates)).

:- doc(title,&quot;A simple database application using argument names&quot;).

:- data
product( id,    description,    brand,          quantity        ).
%       ----------------------------------------------------------
product(  1,    &quot;Keyboard&quot;,     &quot;Logitech&quot;,     6               ).
product(  2,    &quot;Mouse&quot;,        &quot;Logitech&quot;,     5               ).
product(  3,    &quot;Monitor&quot;,      &quot;Philips&quot;,      3               ).
product(  4,    &quot;Laptop&quot;,       &quot;Dell&quot;,         4               ).
% (${/} must go after argnames)
:- pred product${/}
   ::    int    * string        * string        * int.

% Compute the stock of products from a given brand.
% Note call to findall is equivalent to: findall(Q,product(_,_,Brand,Q),L).

brand_stock(Brand,Stock) :-
        findall(Q,product${brand=&gt;Brand,quantity=&gt;Q},L),
        sumlist(L,Stock).

sumlist([],0).
sumlist([X|T],S) :- 
        sumlist(T,S1),
        S is X + S1.


</pre> <p></div><div id="Complete code for the zebra example"><h3>Complete code for the zebra example</h3> <p><pre>:- module(_,zebra/3,[argnames]).

/*     There are five consecutive houses, each of a different
color and inhabited by men of different nationalities. They each
own a different pet, have a different favorite drink, and drive a
different car.

1.   The Englishman lives in the red house.
2.   The Spaniard owns the dog.
3.   Coffee is drunk in the green house.
4.   The Ukrainian drinks tea.
5.   The green house is immediately to the right of the ivory
     house.
6.   The Porsche driver owns snails.
7.   The Masserati is driven by the man who lives in the yellow
     house.
8.   Milk is drunk in the middle house.
9.   The Norwegian lives in the first house on the left.
10.  The man who drives a Saab lives in the house next to the man
     with the fox.
11.  The Masserati is driven by the man in the house next to the
     house where the horse is kept.
12.  The Honda driver drinks orange juice.
13.  The Japanese drives a Jaguar.
14.  The Norwegian lives next to the blue house.

The problem is: Who owns the Zebra?  Who drinks water?
*/

:- argnames house(color, nation, pet, drink, car).

zebra(Owns_zebra, Drinks_water, Street) :-
        Street = [house${},house${},house${},house${},house${}],
        member(house${nation =&gt; Owns_zebra, pet =&gt; zebra}, Street),
        member(house${nation =&gt; Drinks_water, drink =&gt; water}, Street),
        member(house${nation =&gt; englishman, color =&gt; red}, Street),
        member(house${nation =&gt; spaniard, pet =&gt; dog}, Street),
        member(house${drink =&gt; coffee, color =&gt; green}, Street),
        member(house${nation =&gt; ukrainian, drink =&gt; tea}, Street),
        left_right(house${color =&gt; ivory}, house${color =&gt; green}, Street),
        member(house${car =&gt; porsche, pet =&gt; snails}, Street),
        member(house${car =&gt; masserati, color =&gt; yellow}, Street),
        Street = [_, _, house${drink =&gt; milk}, _, _],
        Street = [house${nation =&gt; norwegian}|_],
        next_to(house${car =&gt; saab}, house${pet =&gt; fox}, Street),
        next_to(house${car =&gt; masserati}, house${pet =&gt; horse}, Street),
        member(house${car =&gt; honda, drink =&gt; orange_juice}, Street),
        member(house${nation =&gt; japanese, car =&gt; jaguar}, Street),
        next_to(house${nation =&gt; norwegian}, house${color =&gt; blue}, Street).


member(X,[X|_]).
member(X,[_|Y]) :- member(X,Y).

left_right(L,R,[L,R|_]).
left_right(L,R,[_|T]) :- left_right(L,R,T).

next_to(X,Y,L) :- left_right(X,Y,L).
next_to(X,Y,L) :- left_right(Y,X,L).

</pre> <p></div><br/></div><div id="Known bugs and planned improvements"><h2>Known bugs and planned improvements</h2><ul><LI>It would be nice to add a mechanism to portray terms with named arguments in a special (user definable) way.<LI>The predicate <tt>$~</tt> still does not support runtime argnames.</ul></div></div></div></div></div><div class="sidebarwrapper"><div class="sidebar"><IMG SRC="autofigciao-shadow-64h.png"><h2>Package Sections</h2><ul><LI><a href="#Usage and interface">Usage and interface</a><LI><a href="#Documentation on new declarations">Documentation on new declarations</a><LI><a href="#Documentation on exports">Documentation on exports</a><LI><a href="#Other information">Other information</a><ul><LI><a href="#Using argument names in a toy database">Using argument names in a toy database</a><LI><a href="#Complete code for the zebra example">Complete code for the zebra example</a></ul><LI><a href="#Known bugs and planned improvements">Known bugs and planned improvements</a></ul><h2>Global Links</h2><ul><LI><a href="ciaofulltoc.html">Table of Contents</a><LI><a href="ciaochanges.html">Version/Change Log</a><LI><a href="ciaorefs.html">References</a><LI><a href="ciaocopyright.html">Copyright</a></ul><h2>Indices</h2><ul><LI><a href="ciaoliindex.html">Library/Module Index</a><LI><a href="ciaopdindex.html">Predicate/Method Index</a><LI><a href="ciaoprindex.html">Property Index</a><LI><a href="ciaoteindex.html">Regular Type Index</a><LI><a href="ciaodeindex.html">Declaration Index</a><LI><a href="ciaocoindex.html">Concept Index</a><LI><a href="ciaoauindex.html">Author Index</a><LI><a href="ciaoglindex.html">Global Index</a></ul></div></div><div class="clearer"></div></div><div class="nav"><span class="on_right"><a class="navbutton" href="hiordlib.html">&#x25C4;</a><a class="navbutton" href="fsyntax_doc.html">&#x25BA;</a></span><span>&nbsp;</span></div><div class="footer">Generated with LPdoc using Ciao</div></body></html>