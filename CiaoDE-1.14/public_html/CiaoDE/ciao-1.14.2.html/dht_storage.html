<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/><link rel="stylesheet" href="lpdoc.css" type="text/css"/><title>Underlying data-storage module &mdash; The Ciao System v1.14#2</title></head><body><div class="nav"><span class="on_right"><a class="navbutton" href="dht_rpr.html">&#x25C4;</a><a class="navbutton" href="dht_config.html">&#x25BA;</a></span><span><a href="ciao.html">The Ciao System</a> &raquo; <a href="Contrib.html">PART XI - Contributed libraries</a> &raquo; <a href="dht_doc.html">Ciao DHT Implementation</a> &raquo; <a href="dht_server.html">Top-level interface to a DHT server</a> &raquo; <a href="dht_logic.html">DHT-related logics</a> &raquo; </span></div><div class="documentwrapper"><div class="document"><div class="mainwrapper"><div class="main"><div id=""><h1>Underlying data-storage module</h1><a class="idx_anchor" href="ciaoliindex.html#dht_storage"></a>
<strong>Author(s):</strong> <a class="idx_anchor" id="Arsen Kostenko" href="ciaoauindex.html#Arsen Kostenko">Arsen Kostenko</a>.<p>
This module contains very low-level utilities of data storage specific to a single node. Neither data sharing nor remote invocation is performed at this level. Note that no dedicated data manipulation is performed neither on this level. Also keep in mind that concept of <span class="var">Key</span> should always meet the same constraints as the second argument of <a class="idx_anchor" id="0" href="ciaoglindex.html#functor/3"><tt>functor/3</tt></a> predicate. Important decision taken at this point is representation of all information stored in the DHT as usual Prolog facts. This behavior is implemented by representing relations of form <span class="var">Key</span> -&gt; <span class="var">Value</span> in form of <span class="var">Key</span>(<span class="var">Value</span>) facts.<br/><div id="Usage and interface"><h2>Usage and interface</h2><div class="cartouche"><ul><LI><strong>Library usage:</strong><br/><tt>:- use_module(library(dht_storage)).</tt><LI><strong>Exports:</strong><br/><ul class="itemize_minus"><LI><em>Predicates:</em><br/><a class="idx_anchor" id="1" href="ciaoglindex.html#dht_store/3"><tt>dht_store/3</tt></a>, <a class="idx_anchor" id="2" href="ciaoglindex.html#dht_extract_b/2"><tt>dht_extract_b/2</tt></a>, <a class="idx_anchor" id="3" href="ciaoglindex.html#dht_extract_nb/2"><tt>dht_extract_nb/2</tt></a>, <a class="idx_anchor" id="4" href="ciaoglindex.html#dht_consult_b/2"><tt>dht_consult_b/2</tt></a>, <a class="idx_anchor" id="5" href="ciaoglindex.html#dht_consult_nb/2"><tt>dht_consult_nb/2</tt></a>, <a class="idx_anchor" id="6" href="ciaoglindex.html#dht_key_hash/2"><tt>dht_key_hash/2</tt></a>.
</ul><LI><strong>Other modules used:</strong><br/><ul class="itemize_minus"><LI><em>System library modules:</em><br/><a class="idx_anchor" id="7" href="ciaoglindex.html#concurrency/concurrency"><tt>concurrency/concurrency</tt></a>.
</ul></ul></div></div><div id="Documentation on exports"><h2>Documentation on exports</h2><div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="dht_store/3" href="ciaopdindex.html#dht_store/3">dht_store/3</a>:</div><div class="deftext">This predicate stores information into the local (module-local) database. The three arguments stand for key, value, and value of hash-function, when applied to the key. The third argument is needed for auxiliary database, which is used by reverse lookup.<p><strong>Usage:</strong> <tt>dht_store(Key,KeyHash,Value)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> The value provided in <span class="var">Value</span> is stored under a key given as <span class="var">Key</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">KeyHash</span> is an integer.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="dht_extract_b/2" href="ciaopdindex.html#dht_extract_b/2">dht_extract_b/2</a>:</div><div class="deftext">Looks up local database for fact of following type <span class="var">Key</span>/1, that takes <span class="var">Value</span> as argument. The pair is extracted from the database if there is at lease one match. Otherwise call is blocking once the fact is not found instantly.<p><strong>Usage 1:</strong> <tt>dht_extract_b(Key,Value)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Search for exact fact.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
</ul><p><strong>Usage 2:</strong> <tt>dht_extract_b(Key,Value)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Search for fact matching pattern. Pattern is supplied as <span class="var">Value</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Value</span> is a free variable.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="dht_extract_nb/2" href="ciaopdindex.html#dht_extract_nb/2">dht_extract_nb/2</a>:</div><div class="deftext">Looks up the local database for a fact of type <span class="var">Key</span>/1 that takes <span class="var">Value</span> as argument. If a corresponding fact is found in database, it is extracted from it. With respect to behavior of <a class="idx_anchor" id="8" href="ciaoglindex.html#dht_extract_b/2"><tt>dht_extract_b/2</tt></a>, this predicated has a useful difference - it does not block while searching.<p><strong>Usage 1:</strong> <tt>dht_extract_nb(Key,Value)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Check that combination of <span class="var">Key</span>/<span class="var">Value</span> appears in database.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
</ul><p><strong>Usage 2:</strong> <tt>dht_extract_nb(Key,Value)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Search for combination of <span class="var">Key</span>/<span class="var">Value</span> matching pattern. Pattern is supplied as <span class="var">Value</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Value</span> is a free variable.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="dht_consult_b/2" href="ciaopdindex.html#dht_consult_b/2">dht_consult_b/2</a>:</div><div class="deftext">Looks up local database for combination of <span class="var">Key</span>/<span class="var">Value</span> of following type <span class="var">Key</span>/1 that takes <span class="var">Value</span> as argument. The combination of <span class="var">Key</span>/<span class="var">Value</span> is only looked up. If there is no corresponding combination of <span class="var">Key</span>/<span class="var">Value</span> in local database, <a class="idx_anchor" id="9" href="ciaoglindex.html#dht_consult_b/2"><tt>dht_consult_b/2</tt></a> blocks until such fact is inserted. Nothing is done neither to combination of <span class="var">Key</span>/<span class="var">Value</span> nor to local database.<p><strong>Usage 1:</strong> <tt>dht_consult_b(Key,Value)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Search for exact combination of <span class="var">Key</span>/<span class="var">Value</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
</ul><p><strong>Usage 2:</strong> <tt>dht_consult_b(Key,Value)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Search for combination of <span class="var">Key</span>/<span class="var">Value</span> matching pattern. Pattern is supplied as <span class="var">Value</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="dht_consult_nb/2" href="ciaopdindex.html#dht_consult_nb/2">dht_consult_nb/2</a>:</div><div class="deftext">Looks up local database for combination of <span class="var">Key</span>/<span class="var">Value</span> of following type <span class="var">Key</span>/1 that takes <span class="var">Value</span> as argument. The combination of <span class="var">Key</span>/<span class="var">Value</span> is only looked up - no modifications are done in any case (whether a match was found or not). As in case with <a class="idx_anchor" id="10" href="ciaoglindex.html#dht_extract_nb/2"><tt>dht_extract_nb/2</tt></a>, this predicate does not block while searching for matching values.<p><strong>Usage 1:</strong> <tt>dht_consult_nb(Key,Value)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Search for exact combination of <span class="var">Key</span>/<span class="var">Value</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
</ul><p><strong>Usage 2:</strong> <tt>dht_consult_nb(Key,Value)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Search for combination of <span class="var">Key</span>/<span class="var">Value</span> matching pattern. Pattern is supplied as <span class="var">Value</span>.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Key</span> is an atom.
</span><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Value</span> is ground.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="dht_key_hash/2" href="ciaopdindex.html#dht_key_hash/2">dht_key_hash/2</a>:</div><div class="deftext">A general read-interface to auxiliary database, in order to perform reverse search: &apos;get set of keys by corresponding value of hash function&apos;.<p><strong>Usage 1:</strong> <tt>dht_key_hash(Key,KeyHash)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> The most general case (when both arguments are free) is searching for any key-hash pair stored in auxiliary database. <LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Key</span> is a free variable.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">KeyHash</span> is a free variable.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Key</span> is ground.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">KeyHash</span> is an integer.
</span>
</ul><p><strong>Usage 2:</strong> <tt>dht_key_hash(Key,KeyHash)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Here <span class="var">Key</span> is ground, which in turn leads to search for information on concrete predicate.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Key</span> is ground.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">KeyHash</span> is a free variable.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Key</span> is ground.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">KeyHash</span> is an integer.
</span>
</ul><p><strong>Usage 3:</strong> <tt>dht_key_hash(Key,KeyHash)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> On the contrary to previous example, this one has only second argument <span class="var">KeyHash</span> ground. Therefore, this type of call would search for keys, that where mapped into given value of hash-function.<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Key</span> is a free variable.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">KeyHash</span> is an integer.
</span>
<LI><em>The following properties should hold upon exit:</em><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Key</span> is ground.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">KeyHash</span> is an integer.
</span>
</ul><p><strong>Usage 4:</strong> <tt>dht_key_hash(Key,KeyHash)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Finally, calling <a class="idx_anchor" id="11" href="ciaoglindex.html#dht_key_hash"><tt>dht_key_hash</tt></a> with both arguments ground is similar to straight-forward check on auxiliary database, or to asking a question: &ldquo;Does auxiliary database has any information on this key, which is mapped into that hash value?&rdquo;<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (basic_props:gnd/1)</span><span><span class="var">Key</span> is ground.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">KeyHash</span> is an integer.
</span>
</ul></div></div><p>
</div></div></div></div></div><div class="sidebarwrapper"><div class="sidebar"><IMG SRC="autofigciao-shadow-64h.png"><h2>Module Sections</h2><ul><LI><a href="#Usage and interface">Usage and interface</a><LI><a href="#Documentation on exports">Documentation on exports</a></ul><h2>Global Links</h2><ul><LI><a href="ciaofulltoc.html">Table of Contents</a><LI><a href="ciaochanges.html">Version/Change Log</a><LI><a href="ciaorefs.html">References</a><LI><a href="ciaocopyright.html">Copyright</a></ul><h2>Indices</h2><ul><LI><a href="ciaoliindex.html">Library/Module Index</a><LI><a href="ciaopdindex.html">Predicate/Method Index</a><LI><a href="ciaoprindex.html">Property Index</a><LI><a href="ciaoteindex.html">Regular Type Index</a><LI><a href="ciaodeindex.html">Declaration Index</a><LI><a href="ciaocoindex.html">Concept Index</a><LI><a href="ciaoauindex.html">Author Index</a><LI><a href="ciaoglindex.html">Global Index</a></ul></div></div><div class="clearer"></div></div><div class="nav"><span class="on_right"><a class="navbutton" href="dht_rpr.html">&#x25C4;</a><a class="navbutton" href="dht_config.html">&#x25BA;</a></span><span>&nbsp;</span></div><div class="footer">Generated with LPdoc using Ciao</div></body></html>