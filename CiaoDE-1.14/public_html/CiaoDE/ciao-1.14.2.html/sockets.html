<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/><link rel="stylesheet" href="lpdoc.css" type="text/css"/><title>The socket interface &mdash; The Ciao System v1.14#2</title></head><body><div class="nav"><span class="on_right"><a class="navbutton" href="conc_aggregates.html">&#x25C4;</a><a class="navbutton" href="sockets_io.html">&#x25BA;</a></span><span><a href="ciao.html">The Ciao System</a> &raquo; <a href="MiscProlog.html">PART VI - Ciao library miscellanea</a> &raquo; </span></div><div class="documentwrapper"><div class="document"><div class="mainwrapper"><div class="main"><div id=""><h1>The socket interface</h1><a class="idx_anchor" href="ciaoliindex.html#sockets"></a>
<strong>Author(s):</strong> <a class="idx_anchor" id="Manuel Carro" href="ciaoauindex.html#Manuel Carro">Manuel Carro</a>, <a class="idx_anchor" id="Daniel Cabeza" href="ciaoauindex.html#Daniel Cabeza">Daniel Cabeza</a>.<p>
This module defines primitives to open sockets, send, and receive data from them. This allows communicating with other processes, on the same machine or across the Internet. The reader should also consult standard bibliography on the topic for a proper use of these primitives.<br/><div id="Usage and interface"><h2>Usage and interface</h2><div class="cartouche"><ul><LI><strong>Library usage:</strong><br/><tt>:- use_module(library(sockets)).</tt><LI><strong>Exports:</strong><br/><ul class="itemize_minus"><LI><em>Predicates:</em><br/><a class="idx_anchor" id="0" href="ciaoglindex.html#connect_to_socket_type/4"><tt>connect_to_socket_type/4</tt></a>, <a class="idx_anchor" id="1" href="ciaoglindex.html#connect_to_socket/3"><tt>connect_to_socket/3</tt></a>, <a class="idx_anchor" id="2" href="ciaoglindex.html#bind_socket/3"><tt>bind_socket/3</tt></a>, <a class="idx_anchor" id="3" href="ciaoglindex.html#socket_accept/2"><tt>socket_accept/2</tt></a>, <a class="idx_anchor" id="4" href="ciaoglindex.html#select_socket/5"><tt>select_socket/5</tt></a>, <a class="idx_anchor" id="5" href="ciaoglindex.html#socket_send/2"><tt>socket_send/2</tt></a>, <a class="idx_anchor" id="6" href="ciaoglindex.html#socket_recv_code/3"><tt>socket_recv_code/3</tt></a>, <a class="idx_anchor" id="7" href="ciaoglindex.html#socket_recv/2"><tt>socket_recv/2</tt></a>, <a class="idx_anchor" id="8" href="ciaoglindex.html#socket_shutdown/2"><tt>socket_shutdown/2</tt></a>, <a class="idx_anchor" id="9" href="ciaoglindex.html#hostname_address/2"><tt>hostname_address/2</tt></a>.
<LI><em>Regular Types:</em><br/><a class="idx_anchor" id="10" href="ciaoglindex.html#socket_type/1"><tt>socket_type/1</tt></a>, <a class="idx_anchor" id="11" href="ciaoglindex.html#shutdown_type/1"><tt>shutdown_type/1</tt></a>.
</ul><LI><strong>Other modules used:</strong><br/><ul class="itemize_minus"><LI><em>System library modules:</em><br/><a class="idx_anchor" id="12" href="ciaoglindex.html#foreign_interface/foreign_interface_properties"><tt>foreign_interface/foreign_interface_properties</tt></a>.
</ul></ul></div></div><div id="Documentation on exports"><h2>Documentation on exports</h2><div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="connect_to_socket_type/4" href="ciaopdindex.html#connect_to_socket_type/4">connect_to_socket_type/4</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>connect_to_socket_type(Host,Port,Type,Stream)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Returns a <span class="var">Stream</span> which connects to <span class="var">Host</span>. The <span class="var">Type</span> of connection can be defined. A <span class="var">Stream</span> is returned, which can be used to <a class="idx_anchor" id="13" href="ciaoglindex.html#write/2"><tt>write/2</tt></a> to, to <a class="idx_anchor" id="14" href="ciaoglindex.html#read/2"><tt>read/2</tt></a>, to <a class="idx_anchor" id="15" href="ciaoglindex.html#socket_send/2"><tt>socket_send/2</tt></a> to, or to <a class="idx_anchor" id="16" href="ciaoglindex.html#socket_recv/2"><tt>socket_recv/2</tt></a> from the socket.<LI><em>Calls should, and exit will be compatible with:</em><br/><span class="on_right"> (term_typing:atom/1)</span><span><span class="var">Host</span> is currently instantiated to an atom.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Port</span> is an integer.
</span><br/><span class="on_right"> (sockets:socket_type/1)</span><span><span class="var">Type</span> is a valid socket type.
</span><br/><span class="on_right"> (streams_basic:stream/1)</span><span><span class="var">Stream</span> is an open stream.
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Host</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Port</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Type</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Stream</span> is a free variable.
</span>
<LI><em>The following properties hold globally:</em><br/><span class="on_right"> (foreign_interface_properties:foreign_low/2)</span><span>The Prolog predicate <a class="idx_anchor" id="17" href="ciaoglindex.html#PrologName"><tt>PrologName</tt></a> is implemented using the function <tt>ForeignName</tt>. The same considerations as above example are to be applied.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="connect_to_socket/3" href="ciaopdindex.html#connect_to_socket/3">connect_to_socket/3</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>connect_to_socket(Host,Port,Stream)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Calls <a class="idx_anchor" id="18" href="ciaoglindex.html#connect_to_socket_type/4"><tt>connect_to_socket_type/4</tt></a> with SOCK_STREAM connection type. This is the connection type you want in order to use the <a class="idx_anchor" id="19" href="ciaoglindex.html#write/2"><tt>write/2</tt></a> and <a class="idx_anchor" id="20" href="ciaoglindex.html#read/2"><tt>read/2</tt></a> predicates (and other stream IO related predicates).<LI><em>Call and exit should be compatible with:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Host</span> is an atom.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Port</span> is an integer.
</span><br/><span class="on_right"> (streams_basic:stream/1)</span><span><span class="var">Stream</span> is an open stream.
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Host</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Port</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Stream</span> is a free variable.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="bind_socket/3" href="ciaopdindex.html#bind_socket/3">bind_socket/3</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>bind_socket(Port,Length,Socket)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Returs an AF_INET <span class="var">Socket</span> bound to <span class="var">Port</span> (which may be assigned by the OS or defined by the caller), and listens to it (hence no listen call in this set of primitives). <span class="var">Length</span> specifies the maximum number of pending connections.<LI><em>Calls should, and exit will be compatible with:</em><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Port</span> is an integer.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Length</span> is an integer.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Socket</span> is an integer.
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Length</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Socket</span> is a free variable.
</span>
<LI><em>The following properties hold globally:</em><br/><span class="on_right"> (foreign_interface_properties:foreign_low/2)</span><span>The Prolog predicate <a class="idx_anchor" id="21" href="ciaoglindex.html#PrologName"><tt>PrologName</tt></a> is implemented using the function <tt>ForeignName</tt>. The same considerations as above example are to be applied.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="socket_accept/2" href="ciaopdindex.html#socket_accept/2">socket_accept/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>socket_accept(Sock,Stream)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Creates a new <span class="var">Stream</span> connected to <span class="var">Sock</span>.<LI><em>Calls should, and exit will be compatible with:</em><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Sock</span> is an integer.
</span><br/><span class="on_right"> (streams_basic:stream/1)</span><span><span class="var">Stream</span> is an open stream.
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Sock</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">Stream</span> is a free variable.
</span>
<LI><em>The following properties hold globally:</em><br/><span class="on_right"> (foreign_interface_properties:foreign_low/2)</span><span>The Prolog predicate <a class="idx_anchor" id="22" href="ciaoglindex.html#PrologName"><tt>PrologName</tt></a> is implemented using the function <tt>ForeignName</tt>. The same considerations as above example are to be applied.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="select_socket/5" href="ciaopdindex.html#select_socket/5">select_socket/5</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>select_socket(Socket,NewStream,TO_ms,Streams,ReadStreams)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Wait for data available in a list of <span class="var">Streams</span> and in a <span class="var">Socket</span>. <span class="var">Streams</span> is a list of Prolog streams which will be tested for reading. <span class="var">Socket</span> is a socket (i.e., an integer denoting the O.S. port number) or a <a class="idx_anchor" id="23" href="ciaoglindex.html#free variable">free variable</a>. <span class="var">TO_ms</span> is a number denoting a timeout. Within this timeout the <span class="var">Streams</span> and the <span class="var">Socket</span> are checked for the availability of data to be read. <span class="var">ReadStreams</span> is the list of streams belonging to <span class="var">Streams</span> which have data pending to be read. If <span class="var">Socket</span> was a free variable, it is ignored, and <span class="var">NewStream</span> is not checked. If <span class="var">Socket</span> was instantiated to a port number and there are connections pending, a connection is accepted and connected with the Prolog stream in <span class="var">NewStream</span>.<LI><em>Calls should, and exit will be compatible with:</em><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Socket</span> is an integer.
</span><br/><span class="on_right"> (streams_basic:stream/1)</span><span><span class="var">NewStream</span> is an open stream.
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">TO_ms</span> is an integer.
</span><br/><span class="on_right"> (basic_props:list/2)</span><span><span class="var">Streams</span> is a list of <span class="var">stream</span>s.
</span><br/><span class="on_right"> (basic_props:list/2)</span><span><span class="var">ReadStreams</span> is a list of <span class="var">stream</span>s.
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Socket</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">NewStream</span> is a free variable.
</span><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">TO_ms</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Streams</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:var/1)</span><span><span class="var">ReadStreams</span> is a free variable.
</span>
<LI><em>The following properties hold globally:</em><br/><span class="on_right"> (foreign_interface_properties:foreign_low/2)</span><span>The Prolog predicate <a class="idx_anchor" id="24" href="ciaoglindex.html#PrologName"><tt>PrologName</tt></a> is implemented using the function <tt>ForeignName</tt>. The same considerations as above example are to be applied.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="socket_send/2" href="ciaopdindex.html#socket_send/2">socket_send/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>socket_send(Stream,String)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Sends <span class="var">String</span> to the socket associated to <span class="var">Stream</span>. The socket has to be in connected state. <span class="var">String</span> is not supposed to be NULL terminated, since it is a Prolog string. If a NULL terminated string is needed at the other side, it has to be explicitly created in Prolog.<LI><em>Calls should, and exit will be compatible with:</em><br/><span class="on_right"> (streams_basic:stream/1)</span><span><span class="var">Stream</span> is an open stream.
</span><br/><span class="on_right"> (basic_props:string/1)</span><span><span class="var">String</span> is a string (a list of character codes).
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Stream</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">String</span> is currently a term which is not a free variable.
</span>
<LI><em>The following properties hold globally:</em><br/><span class="on_right"> (foreign_interface_properties:foreign_low/2)</span><span>The Prolog predicate <a class="idx_anchor" id="25" href="ciaoglindex.html#PrologName"><tt>PrologName</tt></a> is implemented using the function <tt>ForeignName</tt>. The same considerations as above example are to be applied.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="socket_recv_code/3" href="ciaopdindex.html#socket_recv_code/3">socket_recv_code/3</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>socket_recv_code(Stream,String,Length)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Receives a <span class="var">String</span> from the socket associated to <span class="var">Stream</span>, and returns its <span class="var">Length</span>. If <span class="var">Length</span> is -1, no more data is available.<LI><em>Calls should, and exit will be compatible with:</em><br/><span class="on_right"> (streams_basic:stream/1)</span><span><span class="var">Stream</span> is an open stream.
</span><br/><span class="on_right"> (basic_props:string/1)</span><span><span class="var">String</span> is a string (a list of character codes).
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Length</span> is an integer.
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Stream</span> is currently a term which is not a free variable.
</span>
<LI><em>The following properties hold globally:</em><br/><span class="on_right"> (foreign_interface_properties:foreign_low/2)</span><span>The Prolog predicate <a class="idx_anchor" id="26" href="ciaoglindex.html#PrologName"><tt>PrologName</tt></a> is implemented using the function <tt>ForeignName</tt>. The same considerations as above example are to be applied.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="socket_recv/2" href="ciaopdindex.html#socket_recv/2">socket_recv/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>socket_recv(Stream,String)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> As <a class="idx_anchor" id="27" href="ciaoglindex.html#socket_recv_code/3"><tt>socket_recv_code/3</tt></a>, but the return code is ignored.<LI><em>Call and exit should be compatible with:</em><br/><span class="on_right"> (streams_basic:stream/1)</span><span><span class="var">Stream</span> is an open stream.
</span><br/><span class="on_right"> (basic_props:string/1)</span><span><span class="var">String</span> is a string (a list of character codes).
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Stream</span> is currently a term which is not a free variable.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="socket_shutdown/2" href="ciaopdindex.html#socket_shutdown/2">socket_shutdown/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>socket_shutdown(Stream,How)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> Shut down a duplex communication socket with which <span class="var">Stream</span> is associated. All or part of the communication can be shutdown, depending on the value of <span class="var">How</span>. The atoms <tt>read</tt>, <tt>write</tt>, or <span class="var">read_write</span> should be used to denote the type of closing required.<LI><em>Calls should, and exit will be compatible with:</em><br/><span class="on_right"> (streams_basic:stream/1)</span><span><span class="var">Stream</span> is an open stream.
</span><br/><span class="on_right"> (sockets:shutdown_type/1)</span><span><span class="var">How</span> is a valid shutdown type.
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Stream</span> is currently a term which is not a free variable.
</span><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">How</span> is currently a term which is not a free variable.
</span>
<LI><em>The following properties hold globally:</em><br/><span class="on_right"> (foreign_interface_properties:foreign_low/2)</span><span>The Prolog predicate <a class="idx_anchor" id="28" href="ciaoglindex.html#PrologName"><tt>PrologName</tt></a> is implemented using the function <tt>ForeignName</tt>. The same considerations as above example are to be applied.
</span>
</ul></div></div><p>
<div><span class="on_right">PREDICATE</span><div class="defname"><a class="idx_anchor" id="hostname_address/2" href="ciaopdindex.html#hostname_address/2">hostname_address/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>hostname_address(Hostname,Address)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">Address</span> is unified with the atom representing the address (in AF_INET format) corresponding to <span class="var">Hostname</span>.<LI><em>Calls should, and exit will be compatible with:</em><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Hostname</span> is an atom.
</span><br/><span class="on_right"> (basic_props:atm/1)</span><span><span class="var">Address</span> is an atom.
</span>
<LI><em>The following properties should hold at call time:</em><br/><span class="on_right"> (term_typing:nonvar/1)</span><span><span class="var">Hostname</span> is currently a term which is not a free variable.
</span>
<LI><em>The following properties hold globally:</em><br/><span class="on_right"> (foreign_interface_properties:foreign_low/2)</span><span>The Prolog predicate <a class="idx_anchor" id="29" href="ciaoglindex.html#PrologName"><tt>PrologName</tt></a> is implemented using the function <tt>ForeignName</tt>. The same considerations as above example are to be applied.
</span>
</ul></div></div><p>
<div><span class="on_right">REGTYPE</span><div class="defname"><a class="idx_anchor" id="socket_type/1" href="ciaoteindex.html#socket_type/1">socket_type/1</a>:</div><div class="deftext">Defines the atoms which can be used to specify the socket type recognized by <a class="idx_anchor" id="30" href="ciaoglindex.html#connect_to_socket_type/4"><tt>connect_to_socket_type/4</tt></a>. Defined as follows: <pre>socket_type(stream).
socket_type(dgram).
socket_type(raw).
socket_type(seqpacket).
socket_type(rdm).
</pre><p><strong>Usage:</strong> <tt>socket_type(T)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">T</span> is a valid socket type.</ul></div></div><p>
<div><span class="on_right">REGTYPE</span><div class="defname"><a class="idx_anchor" id="shutdown_type/1" href="ciaoteindex.html#shutdown_type/1">shutdown_type/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> <tt>shutdown_type(T)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">T</span> is a valid shutdown type.</ul></div></div><p>
</div></div></div></div></div><div class="sidebarwrapper"><div class="sidebar"><IMG SRC="autofigciao-shadow-64h.png"><h2>Module Sections</h2><ul><LI><a href="#Usage and interface">Usage and interface</a><LI><a href="#Documentation on exports">Documentation on exports</a></ul><h2>Global Links</h2><ul><LI><a href="ciaofulltoc.html">Table of Contents</a><LI><a href="ciaochanges.html">Version/Change Log</a><LI><a href="ciaorefs.html">References</a><LI><a href="ciaocopyright.html">Copyright</a></ul><h2>Indices</h2><ul><LI><a href="ciaoliindex.html">Library/Module Index</a><LI><a href="ciaopdindex.html">Predicate/Method Index</a><LI><a href="ciaoprindex.html">Property Index</a><LI><a href="ciaoteindex.html">Regular Type Index</a><LI><a href="ciaodeindex.html">Declaration Index</a><LI><a href="ciaocoindex.html">Concept Index</a><LI><a href="ciaoauindex.html">Author Index</a><LI><a href="ciaoglindex.html">Global Index</a></ul></div></div><div class="clearer"></div></div><div class="nav"><span class="on_right"><a class="navbutton" href="conc_aggregates.html">&#x25C4;</a><a class="navbutton" href="sockets_io.html">&#x25BA;</a></span><span>&nbsp;</span></div><div class="footer">Generated with LPdoc using Ciao</div></body></html>