<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/><link rel="stylesheet" href="lpdoc.css" type="text/css"/><title>Extending the syntax &mdash; The Ciao System v1.14#2</title></head><body><div class="nav"><span class="on_right"><a class="navbutton" href="data_facts.html">&#x25C4;</a><a class="navbutton" href="io_aux.html">&#x25BA;</a></span><span><a href="ciao.html">The Ciao System</a> &raquo; <a href="Builtins.html">PART II - The Ciao basic language (engine)</a> &raquo; </span></div><div class="documentwrapper"><div class="document"><div class="mainwrapper"><div class="main"><div id=""><h1>Extending the syntax</h1><a class="idx_anchor" href="ciaoliindex.html#syntax_extensions"></a>
<strong>Author(s):</strong> <a class="idx_anchor" id="Daniel Cabeza" href="ciaoauindex.html#Daniel Cabeza">Daniel Cabeza</a>.<p>
This chapter documents the <a class="idx_anchor" id="0" href="ciaoglindex.html#builtin directives">builtin directives</a> in Ciao for extending the syntax of source files.<p>Note that the <a class="idx_anchor" id="1" href="ciaoglindex.html#ISO-Prolog">ISO-Prolog</a> directive <a class="idx_anchor" id="2" href="ciaoglindex.html#char_conversion/2"><tt>char_conversion/2</tt></a> is not implemented, since Ciao does not (yet) have a character conversion table.<br/><div id="Usage and interface"><h2>Usage and interface</h2><div class="cartouche"><ul><LI><strong>Library usage:</strong><br/>These directives are builtin in Ciao, so nothing special has to be done to use them.</ul></div></div><div id="Documentation on internals"><h2>Documentation on internals</h2><div><span class="on_right">DECLARATION</span><div class="defname"><a class="idx_anchor" id="op/3" href="ciaodeindex.html#op/3">op/3</a>:</div><div class="deftext"><p><strong>Usage:</strong> <span class="on_right"><span class="iso">ISO</span></span><span>:- <tt>op(Priority,Op_spec,Operator)</tt>.</span>
<ul class="itemize_minus"><LI><em>Description:</em> Updates the <a class="idx_anchor" id="3" href="ciaoglindex.html#operator table">operator table</a> for reading the terms in the rest of the current text, in the same way as the builtin <a class="idx_anchor" id="4" href="ciaoglindex.html#op/3"><tt>op/3</tt></a> does. Its scope is local to the current text. Usually included in <a class="idx_anchor" id="5" href="ciaoglindex.html#package file">package file</a>s.<LI><em>The following properties hold at call time:</em><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Priority</span> is an integer.
</span><br/><span class="on_right"> (basic_props:operator_specifier/1)</span><span><span class="var">Op_spec</span> specifies the type and associativity of an operator.
</span><br/><span class="on_right"> (basic_props:atm_or_atm_list/1)</span><span><span class="var">Operator</span> is an atom or a list of atoms.
</span>
</ul></div></div><p>
<div><span class="on_right">DECLARATION</span><div class="defname"><a class="idx_anchor" id="new_declaration/1" href="ciaodeindex.html#new_declaration/1">new_declaration/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> :- <tt>new_declaration(Predicate)</tt>.
<ul class="itemize_minus"><LI><em>Description:</em> Declares <span class="var">Predicate</span> to be a valid declaration in the rest of the current text. Such declarations are simply ignored by the compiler or top level, but can be used by other code processing programs such as an automatic documentator. Also, they can easily translated into standard code (a set of facts and/or rules) by defining a suitable <a class="idx_anchor" id="6" href="ciaoglindex.html#expansion">expansion</a> (e.g., by <a class="idx_anchor" id="7" href="ciaoglindex.html#add_sentence_trans/1"><tt>add_sentence_trans/1</tt></a>, etc.). This is tipically done in <a class="idx_anchor" id="8" href="ciaoglindex.html#package file">package file</a>s.<p>Equivalent to <tt>new_declaration(Predicate, off)</tt>.<LI><em>The following properties hold at call time:</em><br/><span class="on_right"> (basic_props:predname/1)</span><span><span class="var">Predicate</span> is a Name/Arity structure denoting a predicate name: <pre>predname(P/A) :-
        atm(P),
        nnegint(A).
</pre>
</span>
</ul></div></div><p>
<div><span class="on_right">DECLARATION</span><div class="defname"><a class="idx_anchor" id="new_declaration/2" href="ciaodeindex.html#new_declaration/2">new_declaration/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> :- <tt>new_declaration(Predicate,In_Itf)</tt>.
<ul class="itemize_minus"><LI><em>Description:</em> Declares <span class="var">Predicate</span> to be a valid declaration in the rest of the current text. Such declarations will be included in the <a class="idx_anchor" id="9" href="ciaoglindex.html#interface file">interface file</a> for this file if <span class="var">In_Itf</span> is &apos;on&apos;, not if it is &apos;off&apos;. Including such declarations in interface files makes them visible while processing other modules which make use of this one.<LI><em>The following properties hold at call time:</em><br/><span class="on_right"> (basic_props:predname/1)</span><span><span class="var">Predicate</span> is a Name/Arity structure denoting a predicate name: <pre>predname(P/A) :-
        atm(P),
        nnegint(A).
</pre>
</span><br/><span class="on_right"> (syntax_extensions:switch/1)</span><span><span class="var">In_Itf</span> is &apos;on&apos; or &apos;off&apos;
</span>
</ul></div></div><p>
<div><span class="on_right">DECLARATION</span><div class="defname"><a class="idx_anchor" id="load_compilation_module/1" href="ciaodeindex.html#load_compilation_module/1">load_compilation_module/1</a>:</div><div class="deftext"><p><strong>Usage:</strong> :- <tt>load_compilation_module(File)</tt>.
<ul class="itemize_minus"><LI><em>Description:</em> Loads code defined in <span class="var">File</span> into the compiler, usually including predicates which define translations of clauses, sentences, and terms, for use with the declarations <a class="idx_anchor" id="10" href="ciaoglindex.html#add_sentence_trans/2"><tt>add_sentence_trans/2</tt></a> and similar ones. The application order of translations is determined by ascending <em>priority</em> numbers. Normally included in <a class="idx_anchor" id="11" href="ciaoglindex.html#package file">package file</a>s.<LI><em>The following properties hold at call time:</em><br/><span class="on_right"> (streams_basic:sourcename/1)</span><span><span class="var">File</span> is a source name.
</span>
</ul></div></div><p>
<div><span class="on_right">DECLARATION</span><div class="defname"><a class="idx_anchor" id="add_sentence_trans/2" href="ciaodeindex.html#add_sentence_trans/2">add_sentence_trans/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> :- <tt>add_sentence_trans(Predicate,Priority)</tt>.
<ul class="itemize_minus"><LI><em>Description:</em> Starts a translation, defined by <span class="var">Predicate</span>, of the terms read by the compiler in the rest of the current text. For each subsequent term read by the compiler, the translation predicate is called to obtain a new term which will be used by the compiler as if it where the term present in the file. If the call fails, the term is used as such. A list may be returned also, to translate a single term into several terms. Before calling the translation predicate with actual program terms, it is called with an input of <tt>0</tt> to give an opportunity of making initializations for the module, discarding the result (note that normally a 0 could not be there). <span class="var">Predicate</span> must be exported by a module previously loaded with a <a class="idx_anchor" id="12" href="ciaoglindex.html#load_compilation_module/1"><tt>load_compilation_module/1</tt></a> declaration. Normally included in <a class="idx_anchor" id="13" href="ciaoglindex.html#package file">package file</a>s.<LI><em>The following properties hold at call time:</em><br/><span class="on_right"> (syntax_extensions:translation_predname/1)</span><span><span class="var">Predicate</span> is a translation predicate spec (has arity 2 or 3).
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Priority</span> is an integer.
</span>
</ul></div></div><p>
<div><span class="on_right">DECLARATION</span><div class="defname"><a class="idx_anchor" id="add_term_trans/2" href="ciaodeindex.html#add_term_trans/2">add_term_trans/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> :- <tt>add_term_trans(P,Priority)</tt>.
<ul class="itemize_minus"><LI><em>Description:</em> Starts a translation, defined by <span class="var">Predicate</span>, of the terms and sub-terms read by the compiler in the rest of the current text. This translation is performed after all translations defined by <a class="idx_anchor" id="14" href="ciaoglindex.html#add_sentence_trans/1"><tt>add_sentence_trans/1</tt></a> are done. For each subsequent term read by the compiler, and recursively any subterm included, the translation predicate is called to possibly obtain a new term to replace the old one. Care must be taken of not introducing an endless loop of translations. <span class="var">Predicate</span> must be exported by a module previously loaded with a <a class="idx_anchor" id="15" href="ciaoglindex.html#load_compilation_module/1"><tt>load_compilation_module/1</tt></a> declaration. Normally included in <a class="idx_anchor" id="16" href="ciaoglindex.html#package file">package file</a>s.<LI><em>The following properties hold at call time:</em><br/><span class="on_right"> (syntax_extensions:translation_predname/1)</span><span><span class="var">P</span> is a translation predicate spec (has arity 2 or 3).
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Priority</span> is an integer.
</span>
</ul></div></div><p>
<div><span class="on_right">DECLARATION</span><div class="defname"><a class="idx_anchor" id="add_goal_trans/2" href="ciaodeindex.html#add_goal_trans/2">add_goal_trans/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> :- <tt>add_goal_trans(Predicate,Priority)</tt>.
<ul class="itemize_minus"><LI><em>Description:</em> Declares a translation, defined by <span class="var">Predicate</span>, of the goals present in the clauses of the current text. This translation is performed after all translations defined by <a class="idx_anchor" id="17" href="ciaoglindex.html#add_sentence_trans/1"><tt>add_sentence_trans/1</tt></a> and <a class="idx_anchor" id="18" href="ciaoglindex.html#add_term_trans/1"><tt>add_term_trans/1</tt></a> are done. For each clause read by the compiler, the translation predicate is called with each goal present in the clause to possibly obtain other goal to substitute the original one, and the translation is subsequently applied to the resulting goal. Care must be taken of not introducing an endless loop of translations. <span class="var">Predicate</span> must be exported by a module previously loaded with a <a class="idx_anchor" id="19" href="ciaoglindex.html#load_compilation_module/1"><tt>load_compilation_module/1</tt></a> declaration. Bear in mind that this type of translation noticeably slows down compilation. Normally included in <a class="idx_anchor" id="20" href="ciaoglindex.html#package file">package file</a>s.<LI><em>The following properties hold at call time:</em><br/><span class="on_right"> (syntax_extensions:translation_predname/1)</span><span><span class="var">Predicate</span> is a translation predicate spec (has arity 2 or 3).
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Priority</span> is an integer.
</span>
</ul></div></div><p>
<div><span class="on_right">DECLARATION</span><div class="defname"><a class="idx_anchor" id="add_clause_trans/2" href="ciaodeindex.html#add_clause_trans/2">add_clause_trans/2</a>:</div><div class="deftext"><p><strong>Usage:</strong> :- <tt>add_clause_trans(Predicate,Priority)</tt>.
<ul class="itemize_minus"><LI><em>Description:</em> Declares a translation, defined by <span class="var">Predicate</span>, of the clauses of the current text. The translation is performed before <a class="idx_anchor" id="21" href="ciaoglindex.html#add_goal_trans/1"><tt>add_goal_trans/1</tt></a> translations but after <a class="idx_anchor" id="22" href="ciaoglindex.html#add_sentence_trans/1"><tt>add_sentence_trans/1</tt></a> and <a class="idx_anchor" id="23" href="ciaoglindex.html#add_term_trans/1"><tt>add_term_trans/1</tt></a> translations. The usefulness of this translation is that information of the interface of related modules is available when it is performed. For each clause read by the compiler, the translation predicate is called with the first argument instantiated to a structure <tt>clause(Head,Body)</tt>, and the predicate must return in the second argument a similar structure, without changing the functor in <tt>Head</tt> (or fail, in which case the clause is used as is). Before executing the translation predicate with actual clauses it is called with an input of <tt>clause(0,0)</tt>, discarding the result.<LI><em>The following properties hold at call time:</em><br/><span class="on_right"> (syntax_extensions:translation_predname/1)</span><span><span class="var">Predicate</span> is a translation predicate spec (has arity 2 or 3).
</span><br/><span class="on_right"> (basic_props:int/1)</span><span><span class="var">Priority</span> is an integer.
</span>
</ul></div></div><p>
<div><span class="on_right">REGTYPE</span><div class="defname"><a class="idx_anchor" id="translation_predname/1" href="ciaoteindex.html#translation_predname/1">translation_predname/1</a>:</div><div class="deftext">A translation predicate is a predicate of arity 2 or 3 used to make compile-time translations. The compiler invokes a translation predicate instantiating its first argument with the item to be translated, and if the predicate is of arity 3 its third argument with the name of the module where the translation is done. If the call is successful, the second argument is used as if that item were in the place of the original, else the original item is used.<p><strong>Usage:</strong> <tt>translation_predname(P)</tt>
<ul class="itemize_minus"><LI><em>Description:</em> <span class="var">P</span> is a translation predicate spec (has arity 2 or 3).</ul></div></div><p>
</div></div></div></div></div><div class="sidebarwrapper"><div class="sidebar"><IMG SRC="autofigciao-shadow-64h.png"><h2>Module Sections</h2><ul><LI><a href="#Usage and interface">Usage and interface</a><LI><a href="#Documentation on internals">Documentation on internals</a></ul><h2>Global Links</h2><ul><LI><a href="ciaofulltoc.html">Table of Contents</a><LI><a href="ciaochanges.html">Version/Change Log</a><LI><a href="ciaorefs.html">References</a><LI><a href="ciaocopyright.html">Copyright</a></ul><h2>Indices</h2><ul><LI><a href="ciaoliindex.html">Library/Module Index</a><LI><a href="ciaopdindex.html">Predicate/Method Index</a><LI><a href="ciaoprindex.html">Property Index</a><LI><a href="ciaoteindex.html">Regular Type Index</a><LI><a href="ciaodeindex.html">Declaration Index</a><LI><a href="ciaocoindex.html">Concept Index</a><LI><a href="ciaoauindex.html">Author Index</a><LI><a href="ciaoglindex.html">Global Index</a></ul></div></div><div class="clearer"></div></div><div class="nav"><span class="on_right"><a class="navbutton" href="data_facts.html">&#x25C4;</a><a class="navbutton" href="io_aux.html">&#x25BA;</a></span><span>&nbsp;</span></div><div class="footer">Generated with LPdoc using Ciao</div></body></html>